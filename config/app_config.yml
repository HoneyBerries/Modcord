ai_settings:
  enabled: true
  vram_percentage: 0.85 # Percentage of GPU VRAM to use if using GPU (0.0 to 1.0)

  # Path to your local model directory or model identifier from Hugging Face
  model_id: "/mnt/d/Model Folder/modcord_custom_models/qwen3-vl-4b-instruct-nf4"

  sampling_parameters:
    dtype: "bfloat16" # "auto", "half", "float16", "bfloat16", or "float32"; "bfloat16" is efficient for modern GPUs
    max_new_tokens: 1024
    max_model_length: 4096
    temperature: 0.7
    top_p: 0.95
    top_k: 50
    repetition_penalty: 1.1
    presence_penalty: 0.0
    frequency_penalty: 0.0

  # moderation_batch_seconds: time window (in seconds) to group messages for moderation.
  moderation_batch_seconds: 10.0

  # Message cache configuration for dynamic history fetching (Discord API fallback)
  cache:
    max_messages_per_channel: 16 # Maximum messages to retain in memory per channel
    cache_ttl_seconds: 3600 # Time-to-live for cached messages (1 hour default); older messages are discarded
    api_fetch_limit: 128  # Max messages to fetch from Discord API in one call


system_prompt: |
  You are a Discord moderation AI. Your only job is to output JSON-formatted moderation actions.

  --- REASONING/Thought Process ---
  Strictly follow the SERVER_RULES below. Do not invent or ignore rules. Analyze each user's messages only by these rules. Keep reasoning concise and focused.
  
  --- OUTPUT SCHEMA ---
  {
    "channel_id": "<channel_id>",
    "users": [
      {
        "user_id": "<user_id>",
        "action": "null" | "delete" | "warn" | "timeout" | "kick" | "ban",
        "reason": "<reason>",
        "message_ids_to_delete": ["<message_id>", ...],
        "timeout_duration": <seconds or null>,
        "ban_duration": <seconds or 0 for permanent or null>
      }
    ]
  }

  --- RULES ---
  <|SERVER_RULES_INJECT|>

  --- EXAMPLE ---
  {
    "channel_id": "123456",
    "users": [
      {"user_id": "1001", "action": "null", "reason": "clean", "message_ids_to_delete": [], "timeout_duration": null, "ban_duration": null},
      {"user_id": "1002", "action": "delete", "reason": "hate speech - rule 3", "message_ids_to_delete": ["123"], "timeout_duration": null, "ban_duration": null}
    ]
  }


default_server_rules: |
  1. Be respectful to all members and moderators.
  2. No spamming, flooding, or excessive use of caps/emoji. (Minor: occasional caps/emoji; Major: repeated spamming)
  3. No hate speech, racism, sexism, homophobia, or any form of discrimination. (Always major)
  4. Keep content appropriate for all ages; no NSFW, graphic violence, or illegal content. (Always major)
  5. Do not share personal information of yourself or others. (Always major)
  6. Follow Discord's Terms of Service and community guidelines. (Major if violated)
  7. Do not advertise, self-promote, or solicit without permission. (Minor if occasional; Major if repeated or aggressive)
  8. Use channels for their intended purpose and follow pinned channel guidelines. (Minor if off-topic once; Major if repeated)
  9. Report serious issues to moderators instead of attempting vigilante action.
  10. Repeated or intentional breaking of rules may result in warnings, timeouts, kicks, or bans.