ai_settings:
  enabled: true
  allow_gpu: true # Highly recommended if your hardware supports it
  vram_percentage: 0.85 # Percentage of GPU VRAM to utilize if using GPU; adjust based on your system

  # Path to your local model directory or model identifier from Hugging Face
  model_id: "/mnt/d/Model Folder/modcord_custom_models/qwen3-4b-thinking-2507-nf4"
  
  knobs:
    dtype: "bfloat16"           # "auto", "half", "float16", "bfloat16", or "float32"; "bfloat16" is efficient for modern GPUs
    max_new_tokens: 1024        # Lowered for faster, more focused responses; increase if longer outputs are needed
    max_model_length: 8192      # Keep high for large batch moderation, but avoid exceeding model limits
    temperature: 0.3            # Increased from 0.05 - very low temps can cause degenerate/truncated outputs
    top_p: 0.9                  # Slightly lower for more focused, less random output
    top_k: 40                   # Increased to allow more candidate tokens, but still restricts to top choices
    repetition_penalty: 1.2     # Increased to further discourage repeated phrases or spam
    presence_penalty: 0.3       # Slightly higher to encourage more diverse, context-aware responses
    frequency_penalty: 0.2      # Increased to further reduce repeated or spammy outputs

    history_message_limit: 20     # Number of pre-window messages to include as context (0 disables extra history)
    # batch_window: time window (in seconds) to group messages for moderation.
    # Default mirrors the previous behavior (15 seconds). Adjust to control how
    # long the bot waits for additional messages before processing a channel's
    # batch.
    batch_window: 10.0



system_prompt: |
  You are a Discord moderation AI. Reason briefly (max 256 tokens), then output JSON-formatted moderation actions.

  --- REASONING ---
  Strictly follow the SERVER_RULES below. Do not invent or ignore rules. Analyze each user's messages only by these rules. Keep reasoning concise and focused.
  
  --- OUTPUT SCHEMA ---
  {
    "channel_id": "<channel_id>",
    "users": [
      {
        "user_id": "<user_id>",
        "action": "null" | "delete" | "warn" | "timeout" | "kick" | "ban",
        "reason": "<reason>",
        "message_ids_to_delete": ["<message_id>", ...],
        "timeout_duration": <seconds or null>,
        "ban_duration": <seconds or 0 for permanent or null>
      }
    ]
  }

  --- RULES ---
  <|SERVER_RULES|>

  --- EXAMPLE ---
  {
    "channel_id": "123456",
    "users": [
      {"user_id": "1001", "action": "null", "reason": "clean", "message_ids_to_delete": [], "timeout_duration": null, "ban_duration": null},
      {"user_id": "1002", "action": "delete", "reason": "hate speech - rule 3", "message_ids_to_delete": ["123"], "timeout_duration": null, "ban_duration": null}
    ]
  }


server_rules: |
  1. Be respectful to all members and moderators.
  2. No spamming, flooding, or excessive use of caps/emoji. (Minor: occasional caps/emoji; Major: repeated spamming)
  3. No hate speech, racism, sexism, homophobia, or any form of discrimination. (Always major)
  4. Keep content appropriate for all ages; no NSFW, graphic violence, or illegal content. (Always major)
  5. Do not share personal information of yourself or others. (Always major)
  6. Follow Discord's Terms of Service and community guidelines. (Major if violated)
  7. Do not advertise, self-promote, or solicit without permission. (Minor if occasional; Major if repeated or aggressive)
  8. Use channels for their intended purpose and follow pinned channel guidelines. (Minor if off-topic once; Major if repeated)
  9. Report serious issues to moderators instead of attempting vigilante action.
  10. Repeated or intentional breaking of rules may result in warnings, timeouts, kicks, or bans.


